<!DOCTYPE HTML>
	<html lang="pt-br">
	<head>
		<meta charset="UTF-8">

		<title>Cadastro de Investimento Fixo</title>
		
		<!-- JQuery -->
		<script src="js/jquery-3.1.1.min.js"></script>

		<!-- bootstrap - link cdn -->
		<link rel="stylesheet" href="css/bootstrap.min.css">
	
		<!-- incluindo css -->
		<link href="css/style.css" rel="stylesheet">
		<link rel='stylesheet' type='text/css' href='css/PDCalendario.css'>
		<script language="JavaScript" src="JavaScript/ActionValidation.js" type="text/javascript"></script>
		<script language="JavaScript" src="JavaScript/JsFunction.js" type="text/javascript"></script>
	<script language='JavaScript' src='JavaScript/PDCalendario.js' type='text/javascript'></script>		<script language='JavaScript' src='JavaScript/GmUtil.js' type='text/javascript'></script>
		<script language='JavaScript' src='JavaScript/ValidaData.js' type='text/javascript'></script>
		
		<script type="text/javascript" src="JavaScript/AutoCompletar.js"></script>
		<script type="text/javascript">
	 function Acao(tp,aviso,categoria,datadeaquisicao,depreciavel,descricaodobem,empresa,idsetor,marca,modelo,precodobem,quantidade,sequencia,subcategoria,taxadepreciavelmes,status,vidadepreciavel)
			{
				var vForm = document.getElementById("frm");
				//vForm.nomesistema.focus();  
				if (tp == "Ed"){
					vForm.aviso.value=aviso;
					vForm.categoria.value=categoria;
					vForm.datadeaquisicao.value=datadeaquisicao.substr(8, 2)+"/"+datadeaquisicao.substr(5, 2)+"/"+datadeaquisicao.substr(0, 4);
					vForm.depreciavel.value=depreciavel;
					vForm.descricaodobem.value=descricaodobem;
					vForm.empresa.value=empresa;
					vForm.idsetor.value=idsetor;
					vForm.marca.value=marca;
					vForm.modelo.value=modelo;
					vForm.precodobem.value=precodobem.replace("R$","").replace(".","").replace(",",".");
					vForm.quantidade.value=quantidade;
					vForm.sequencia.value=sequencia;
					vForm.subcategoria.value=subcategoria;
					vForm.taxadepreciavelmes.value=taxadepreciavelmes;
					vForm.status.value=status;
					vForm.vidadepreciavel.value=vidadepreciavel;
			    	vForm.btn_ok.innerHTML = "Alterar";
			    	vForm.action="/Cmoatualizarmaquinasequipamentosferramentas";
			    	vForm.method="put";
			    	vForm.btn_ok.disabled = false;
			    	return;
				}
				if (tp == "Nv"){
						vForm.btn_ok.innerHTML = "Confirmar";
						vForm.aviso.value=0;
						vForm.categoria.value=0;
						vForm.datadeaquisicao.value="";
						vForm.depreciavel.value="";
						vForm.descricaodobem.value="";
						vForm.empresa.value=0;
						vForm.idsetor.value=0;
						vForm.marca.value="";
						vForm.modelo.value="";
						vForm.precodobem.value="";
						vForm.quantidade.value="";
						vForm.sequencia.value=0;
						vForm.subcategoria.value=0;
						vForm.taxadepreciavelmes.value="";
						vForm.status.value=0;
						vForm.vidadepreciavel.value="";
						vForm.action="/Customaoobraincmaquinasequipamentosferramentas";
						vForm.method="post";
						vForm.btn_ok.disabled = false;
						return;
				}
				if (tp == "Psq"){
							vForm.btn_ok.innerHTML = "Pesquisar";
							vForm.aviso.value="";
							vForm.categoria.value="";
							vForm.datadeaquisicao.value="";
							vForm.depreciavel.value="";
							vForm.descricaodobem.value="";
							vForm.empresa.value="";
							vForm.idsetor.value="";
							vForm.marca.value="";
							vForm.modelo.value="";
							vForm.precodobem.value="";
							vForm.quantidade.value="";
							vForm.sequencia.value="";
							vForm.subcategoria.value="";
							vForm.taxadepreciavelmes.value="";
							vForm.status.value="";
							vForm.vidadepreciavel.value="";
							vForm.action="/Customaoobrapesquisarmaquinasequipamentosferramentas";
							vForm.method="get";
							vForm.btn_ok.disabled = false;
				}
				if (tp == "Up"){
					//alert(vForm.filetoupload);
					vForm.descricaodobem.value=descricaodobem;//.replace("\\","--").replace("\\","--").replace(":","%");
					vForm.depreciavel.value="Teste";
					vForm.btn_ok.innerHTML = "UpLoad";
					vForm.action="/Customaoobrauplmaqequipferramentas";
					vForm.method="post";
					vForm.btn_ok.disabled = false;
					return;
				}else{
					vForm.aviso.value=aviso;
					vForm.categoria.value=categoria;
					vForm.datadeaquisicao.value=datadeaquisicao.substr(8, 2)+"/"+datadeaquisicao.substr(5, 2)+"/"+datadeaquisicao.substr(0, 4);
					vForm.depreciavel.value=depreciavel;
					vForm.descricaodobem.value=descricaodobem;
					vForm.empresa.value=empresa;
					vForm.idsetor.value=idsetor;
					vForm.marca.value=marca;
					vForm.modelo.value=modelo;
					vForm.precodobem.value=precodobem;
					vForm.quantidade.value=quantidade;
					vForm.sequencia.value=sequencia;
					vForm.subcategoria.value=subcategoria;
					vForm.taxadepreciavelmes.value=taxadepreciavelmes;
					vForm.status.value=status;
					vForm.vidadepreciavel.value=vidadepreciavel;
			    	vForm.btn_ok.innerHTML = "Excluir";
					vForm.action="/Customaoobraexcmaquinasequipamentosferramentas";
					vForm.method="delete";
					vForm.btn_ok.disabled = false;
				}	 
				 
			}
		</script>
	</head>

	<body>

		<div class="container home">
			<% if(msg != undefined){ %>
				<div class="alert alert-success">
						<strong>Atenção!</strong>
						<ul>
							<li><%=msg%></li>
						</ul>
					</div>
				<% } %>
			<% if(validacao.length > 0){ %>
					<div class="alert alert-danger">
						<strong>Atenção!</strong>
						<ul>
							<% for(var i = 0; i < validacao.length; i++) {%>
								<li><%=validacao[i].msg%></li>
							<% } %>
						</ul>
					</div>
				<% } %>
            <div class="row">
                <div class="col-md-2"></div>
                
                <div class="col-md-12 painel-login">
					<div class="panel panel-default">
						<div class="panel-body">
							<div class="row">
								<div class="col-md-12">

									<img src="img/sistemas.png" class="img-responsive img-center" />
									<br />
									<P id="mensagem"></P>
									<form action="/atualizaMaquinasEquipamentos" method="put" id="frm" name="frm">
										<div class="form-group">
											<select id="empresa" name="empresa">
												<option value=0 selected>Selecione a empresa</option>
												<% function sortByProperty(property){  
													   return function(a,b){  
													      if(a[property] > b[property])  
													         return 1;  
													      else if(a[property] < b[property])  
													         return -1;  
													  
													      return 0;  
													   }; 
													   if(Empresas.length > 0){
													  	Empresas.sort(sortByProperty("nomedaempresa"));
													  } 
													} for(var i = 0; i < Empresas.length; i++) {%>
												<option value="<%=Empresas[i].empresa%>"><%=Empresas[i].nomedaempresa%></option>
												<% } %>
											</select>
										</div>
										<div class="form-group">
											<select name="idsetor" id="idsetor">
												<option value=0 selected>Selecione o Setor</option>
												<% if (Setor.length > 0) {
														Setor.sort(sortByProperty("descricao"));
													}
												for (var i = 0; i < Setor.length; i++) {%>
													<option value="<%=Setor[i].idsetor%>"><%=Setor[i].descricao%></option>
												<% } %>
											</select>
										</div>
										<div class="form-group">
											<select name="categoria" id="categoria">
												<option value=0 selected>Selecione a Categoria</option>
												<% if (Categorias.length > 0 ){
													Categorias.sort(sortByProperty("descricao"));
													}
												for (var i = 0; i < Categorias.length; i++) {%>
													<option value="<%=Categorias[i].categoria%>"><%=Categorias[i].descricao%></option>
												<% } %>
											</select>
										</div>
										<div class="form-group"></div>
										<div class="form-group">
											<select name="subcategoria" id="subcategoria">
												<option value=0 selected>Selecione a Sub  Categoria</option>
												<% for (var a = 0; a < Categorias.length; a++) {%>
													<option value="<%=Categorias[a].categoria%>">
														<%=Categorias[a].descricao%>
													</option>
												<% } %>
											</select>
										</div>
										
										
										<div class="form-group">
											<input type="text" name="datadeaquisicao" id="datadeaquisicao" placeholder="Adiquirido em" value="" maxlength=10 size=10 value=""  WIDTH='16' HEIGHT='16 title='Opcional - Digite a data de quando a ordem de serviço perderá a válida no formato DD/MM/AAAA'>
												<img src='../img/PDCalendario.gif' align='middle' onclick="return showCalendar('datadeaquisicao', 'dd/mm/y');javascript:Valida_data(datadeaquisicao,datadeaquisicao,'Anterior','<','dataAtual','Data anterior data atual');" WIDTH='16' HEIGHT='16'>
										</div>
										
										<div class="form-group">
											<input type="text" name="descricaodobem" id="descricaodobemo" class="form-control" placeholder="Informe descricaodobem" value=""></div>
										<div class="form-group">
											<input type="text" name="marca" id="marcao" class="form-control" placeholder="Informe marca" value=""></div>
										<div class="form-group">
											<input type="text" name="modelo" id="modeloo" class="form-control" placeholder="Informe modelo" value=""></div>
										<div class="form-group">
											<input type="text" name="precodobem" id="precodobemo" class="form-control" placeholder="Informe precodobem" value="0.00"></div>
										<div class="form-group">
											<input type="text" name="quantidade" id="quantidadeo" class="form-control" placeholder="Informe quantidade" value="1"></div>
										<div class="form-group">
										<input type="hidden" name="sequencia" id="sequenciao" class="form-control" placeholder="sequencia" value="">
										</div>
										
									<div class="form-group">
										<input type="text" name="aviso" id="aviso" class="form-control" placeholder="Informe aviso" value="">
									</div>
									<script language="javascript">
										//Calcula a taxa depreciacao mensal do bem  
											function CalculaTaxa(){
												var vForm = document.getElementById("frm");
												if(vForm.precodobem.value < 1){
													alert("Informe o preço do bem!")
													vForm.precodobem.focus();
													return;
												}
												if(vForm.quantidade.value < 1){
													alert("Informe a quantidade!");
													vForm.quantidade.focus();
													return;
												}
												var vlr,vlrbem = 0.00;
												vlr = ((parseFloat(vForm.quantidade.value) * parseFloat(vForm.precodobem.value)) / (vForm.vidadepreciavel.value * 12));
												vForm.taxadepreciavelmes.value = vlr / parseFloat(vForm.precodobem.value);
											}
										</script>
									<div class="form-group">
										<select name="depreciavel" id="depreciavel">
											<option value="Sim" selected>Sim</option>
											<option value="Não">Não</option>
										</select>
									</div>
									<div class="form-group">
											<select name="vidadepreciavel" id="vidadepreciavel" onchange="CalculaTaxa()">
												<option value=0 selected>Selecione Vida Útil do Bem</option>
												<option value=1>Um Ano</option>
												<option value=5>Cinco Anos</option>
												<option value=10>Dez Anos</option>
												<option value=2>Dois Anos</option>
												<option value=3>Três Anos</option>
												<option value=4>Quatro Anos</option>
												<option value=6>Seis Anos</option>
												<option value=7>Sete Anos</option>
												<option value=8>Oito Anos</option>
												<option value=9>Nove Anos</option>
												<option value=11>Onze Anos</option>
												<option value=12>Doze Anos</option>
											</select>
										</div>
									<div class="form-group">
										<input type="text" name="taxadepreciavelmes" id="taxadepreciavelmeso" class="form-control" placeholder="Informe taxadepreciavelmes" value="0.00">
									</div>
									<div class="form-group">
										<select id="status" name="status">
											<option value="" selected>Selecione</option>
											<option value=0>Ativo</option>
											<option value=1>Inativo</option>
										</select>
									</div>
						
				<div class="form-group">										
					<button type="submit" id="btn_ok" class="btn btn-primary btn-login" disabled>Confirmar</button>
				</div>	
</form>
								
								</div>
									<div id="lista" name="lista">
				<accordion-group heading="Listagem de Maquinas e Equipamentos" >

			<h4>Lista de Investimento Fixo</h4><button class="btn btn-primary btn-login" onclick="Acao('Nv','','','','','','','','','','','','','','','','')">Novo</button>&nbsp;
			<button class="btn btn-primary btn-login" onclick="Acao('Psq','','','','','','','','','','','','','','','','')" title="Informe a palavra ( todos ) quando desejar listar todos os registros cadastrados">Pesquisar</button><input type="file" id="filetoupload" name="filetoupload" onchange="Acao('Up','','','','',this.value,'','','','','','','','','','','')"><br>
			<table class="table table-striped table-condensed">
				<thead>
				<tr class="login-header">
				<th style="min-width: 60px;">Empresa</th><th style="min-width: 60px;">Categoria</th><th style="min-width: 60px;">Setor</th><th style="min-width: 60px;">Descrição</th><th style="min-width: 60px;">Custo</th><th style="min-width: 60px;">Adquirido em</th><th style="min-width: 60px;">Quantidade</th><th style="min-width: 60px;">Sub Categoria</th><th style="min-width: 60px;">Vida Depreciavel</th>
				</tr>
				</thead>
				<tbody>
					<% 
						if(MaquinasEquipamentos.length > 0) { %>
	    				<% for(var i = 0; i < MaquinasEquipamentos.length; i++) {%>
							<tr>
								<td><%=MaquinasEquipamentos[i].empresa%></td>
								<td><%=MaquinasEquipamentos[i].categoria%></td>
								<td><%=MaquinasEquipamentos[i].idsetor%></td>
								<td nowrap><%=MaquinasEquipamentos[i].descricaodobem%></td>
								<td><%=MaquinasEquipamentos[i].precodobem%></td>
								<td><%=MaquinasEquipamentos[i].datadeaquisicao.substr(8, 2)+"/"+MaquinasEquipamentos[i].datadeaquisicao.substr(5, 2)+"/"+MaquinasEquipamentos[i].datadeaquisicao.substr(0, 4)%></td>
								<td><%=MaquinasEquipamentos[i].quantidade%></td>
								<td><%=MaquinasEquipamentos[i].subcategoria%></td>
								<td><%=MaquinasEquipamentos[i].vidadepreciavel%></td>					
								<td nowrap><%if (MaquinasEquipamentos[i].status == 0) {%>
									<button class="btn btn-primary btn-login" onclick="Acao('Ed','<%=MaquinasEquipamentos[i].aviso%>','<%=MaquinasEquipamentos[i].categoria%>','<%=MaquinasEquipamentos[i].datadeaquisicao%>','<%=MaquinasEquipamentos[i].depreciavel%>','<%=MaquinasEquipamentos[i].descricaodobem%>','<%=MaquinasEquipamentos[i].empresa%>','<%=MaquinasEquipamentos[i].idsetor%>','<%=MaquinasEquipamentos[i].marca%>','<%=MaquinasEquipamentos[i].modelo%>','<%=MaquinasEquipamentos[i].precodobem%>','<%=MaquinasEquipamentos[i].quantidade%>','<%=MaquinasEquipamentos[i].sequencia%>','<%=MaquinasEquipamentos[i].subcategoria%>','<%=MaquinasEquipamentos[i].taxadepreciavelmes%>','<%=MaquinasEquipamentos[i].status%>','<%=MaquinasEquipamentos[i].vidadepreciavel%>')">Editar</button>
									<%}else{%>
											<button class="btn btn-primary btn-login" onclick="Acao('Ed','<%=MaquinasEquipamentos[i].aviso%>','<%=MaquinasEquipamentos[i].categoria%>','<%=MaquinasEquipamentos[i].datadeaquisicao%>','<%=MaquinasEquipamentos[i].depreciavel%>','<%=MaquinasEquipamentos[i].descricaodobem%>','<%=MaquinasEquipamentos[i].empresa%>','<%=MaquinasEquipamentos[i].idsetor%>','<%=MaquinasEquipamentos[i].marca%>','<%=MaquinasEquipamentos[i].modelo%>','<%=MaquinasEquipamentos[i].precodobem%>','<%=MaquinasEquipamentos[i].quantidade%>','<%=MaquinasEquipamentos[i].sequencia%>','<%=MaquinasEquipamentos[i].subcategoria%>','<%=MaquinasEquipamentos[i].taxadepreciavelmes%>',0,'<%=MaquinasEquipamentos[i].vidadepreciavel%>')">Ativar</button>
									<% } %>
									<%if (MaquinasEquipamentos[i].status == 0) {%>
									<button class="btn btn-primary btn-login" onclick="Acao('Ex','<%=MaquinasEquipamentos[i].aviso%>','<%=MaquinasEquipamentos[i].categoria%>','<%=MaquinasEquipamentos[i].datadeaquisicao%>','<%=MaquinasEquipamentos[i].depreciavel%>','<%=MaquinasEquipamentos[i].descricaodobem%>','<%=MaquinasEquipamentos[i].empresa%>','<%=MaquinasEquipamentos[i].idsetor%>','<%=MaquinasEquipamentos[i].marca%>','<%=MaquinasEquipamentos[i].modelo%>','<%=MaquinasEquipamentos[i].precodobem%>','<%=MaquinasEquipamentos[i].quantidade%>','<%=MaquinasEquipamentos[i].sequencia%>','<%=MaquinasEquipamentos[i].subcategoria%>','<%=MaquinasEquipamentos[i].taxadepreciavelmes%>','<%=MaquinasEquipamentos[i].status%>','<%=MaquinasEquipamentos[i].vidadepreciavel%>')">Excluir</button>
									<% } %>
								</td>

							</tr>
						<% } %>
					<% } %>
				</tbody>
			</table>
	
	</accordion-group>
				</div>
											
							</div>
						</div>
					</div>
                </div>

                <div class="col-md-2"></div>
            </div>
        </div>
		
	</body>
</html>