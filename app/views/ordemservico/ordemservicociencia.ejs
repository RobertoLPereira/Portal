<!DOCTYPE HTML>
	<html lang="pt-br">
	<head>
		<meta charset="UTF-8">

		<title>Cadastro de Ciencia de Ordem de Servico</title>
		
		<!-- JQuery -->
		<script src="js/jquery-3.1.1.min.js"></script>

		<!-- bootstrap - link cdn -->
		<link rel="stylesheet" href="css/bootstrap.min.css">
	
		<!-- incluindo css -->
		<link href="css/style.css" rel="stylesheet">
		<link rel='stylesheet' type='text/css' href='css/PDCalendario.css'>
		<script language='JavaScript' src='js/jquery-2.2.1.js' type='text/javascript'></script>
		<script language="JavaScript" src="JavaScript/ActionValidation.js" type="text/javascript"></script>
		<script language="javascript" src="JavaScript/AjaxBrowser.js" type="text/javascript"></script>
		<script language="JavaScript" src="JavaScript/OrdemServicoRN.js" type="text/javascript"></script>
		<script language="JavaScript" src="JavaScript/JsFunction.js" type="text/javascript"></script>
		<script language='JavaScript' src='JavaScript/PDCalendario.js' type='text/javascript'></script>																
		<script language='JavaScript' src='JavaScript/ValidaData.js' type='text/javascript'></script>
		<script language='JavaScript' src='JavaScript/GmUtil.js' type='text/javascript'></script>
		<script language='JavaScript' src='JavaScript/AjaxOrdemServicoPessoa.js' type='text/javascript'></script>
		<script language='JavaScript' src='JavaScript/AjaxSistemas.js' type='text/javascript'></script>
		<script language='JavaScript' src='JavaScript/AjaxPerfilSistema.js' type='text/javascript'></script>
		
		<script type="text/javascript">
	 function Acao(tp,codigousuariorede,dataciencia,idordemservico,idOrdemServicoCiencia,idpessoa,status,corpo)
			{
				//document.getElementById("msgSucesso").innerHTML = " ";
				var vForm = document.getElementById("frm");
				vForm.dataciencia.focus();  
				if (tp == "Ed"){
					vForm.codigousuariorede.value=codigousuariorede;
					vForm.dataciencia.value = dataciencia.substring(5,7) + "/"+dataciencia.substring(8,10)+"/"+dataciencia.substring(0,4);
					vForm.idordemservico.value=idordemservico;
					vForm.idOrdemServicoCiencia.value=idOrdemServicoCiencia;
					vForm.idpessoa.value=idpessoa;
					vForm.status.value=status;
					vForm.corpo.value = corpo;
			    	vForm.btn_ok.innerHTML = "Alterar";
			    	vForm.action="/Atualizaordemservicociencia";
			    	vForm.method="put";
			    	vForm.btn_ok.disabled = false;
			    	return;
				}
				if (tp == "Nv"){
						vForm.btn_ok.innerHTML = "Confirmar";
						vForm.codigousuariorede.value="";
						vForm.dataciencia.value="";
						vForm.idordemservico.value="";
						vForm.idOrdemServicoCiencia.value="";
						vForm.idpessoa.value="";
						vForm.status.value="";
						vForm.action="/validarOrdemServicoCiencia";
						vForm.method="post";
						vForm.btn_ok.disabled = false;
						return;
				}
				if (tp == "Psq"){
							vForm.btn_ok.innerHTML = "Pesquisar";
							vForm.codigousuariorede.value="";
							vForm.dataciencia.value="";
							vForm.idordemservico.value="";
							vForm.idOrdemServicoCiencia.value="";
							vForm.idpessoa.value="";
							vForm.status.value="";
							vForm.action="/pesquisarOrdemServicoCiencia";
							vForm.method="get";
							vForm.btn_ok.disabled = false;
				}else{
							vForm.codigousuariorede.value=codigousuariorede;
							vForm.dataciencia.value=dataciencia;
							vForm.idordemservico.value=idordemservico;
							vForm.idOrdemServicoCiencia.value=idOrdemServicoCiencia;
							vForm.idpessoa.value=idpessoa;
							vForm.status.value=status;
							vForm.btn_ok.innerHTML = "Excluir";
							vForm.action="/excOrdemServicoCiencia";
							vForm.method="delete";
							vForm.btn_ok.disabled = false;
						}	 
				 
			}
		</script></head>

	<body >

		<div class="container home">
			<% if(msg != undefined){ %>
				<div class="alert alert-success" id="msgSucesso">
						<strong>Atenção!</strong>
						<ul>
							<li><%=msg%></li>
						</ul>
					</div>
				<% } %>
			<% if(validacao.length > 0){ %>
					<div class="alert alert-danger">
						<strong>Atenção!</strong>
						<ul>
							<% for(var i = 0; i < validacao.length; i++) {%>
								<li><%=validacao[i].msg%></li>
							<% } %>
						</ul>
					</div>
				<% } %>
            <div class="row">
                <div class="col-md-2"></div>
                
                <div class="col-md-12 painel-login">
					<div class="panel panel-default">
						<div class="panel-body">
							<div class="row">
								<div class="col-md-12">
									<img src="img/sistemas.png" class="img-responsive img-center" />
									<br />
									<P id="mensagem"></P>
									<form action="/atualizaOrdemServicoCiencia" method="put" id="frm" name="frm"><div class="form-group">
									<input type="text" name="codigousuariorede" id="codigousuarioredeo" class="form-control" placeholder=" Informe Usuário de Rede" value=""></div>
								<!--div class="form-group">
									<input type="text" name="dataciencia" id="datacienciao" class="form-control" placeholder=" Informe Data do Aceite" value="">
								</div-->
					 			<tr>
								    <td class="TextAlignRight" nowrap><b>Data do Aceite:&nbsp;</b></td>
								    <td colspan=3><input id="dataciencia" name="dataciencia" maxlength=10 size=10 value="" title='Opcional - Digite a data de quando a ordem de serviço passará a ter válida no formato DD/MM/AAAA' 
			    			  onblur="javascript:Valida_data(dataciencia,dataciencia,'Anterior','<','Atual','Data anterior ao inicio da validade')"
			    			   onchange="javascript:Valida_data(dataciencia,dataciencia,'Anterior','<','Atual','Data anterior ao inicio da validade')">
                              <img src='../img/PDCalendario.gif' align='middle' onclick="return showCalendar('dataciencia', 'dd/mm/y');javascript:Valida_data(dataciencia,dataciencia,'Anterior','<','Atual','Data anterior ao inicio da validade');" WIDTH='16' HEIGHT='16'>
					            </td>
						  	</tr>
								<div class="form-group">
									<input type="text" name="idordemservico" id="idordemservicoo" class="form-control" placeholder=" Informe Ordem de Serviço" value=""></div>
								<div class="form-group">
									<input type="hidden" name="idOrdemServicoCiencia" id="idOrdemServicoCienciao" class="form-control" placeholder="idOrdemServicoCiencia" value=""></div>
								<div class="form-group">
									<input type="text" name="idpessoa" id="idpessoao" class="form-control" placeholder=" Informe Pessoa" value="">
								</div>
								<div class="form-group">
									<textarea id=corpo name=corpo rows=5 cols=100 placeholder="Objetivo da Ordem de Serviço" readonly="true"></textarea>
							  	</div>
								<div class="form-group">
									<select name="status" id="statuso">
										<option value= selected>Selecione</option>
										<option value=0>Aceitar</option>
										<option value=1>Recusado</option>
									</select>
									</div>
								<div class="form-group">										
										<button type="submit" id="btn_ok" class="btn btn-primary btn-login" disabled>Confirmar</button>
								</div>	
								</form>
																
								</div>
									<div id="lista" name="lista">
										<accordion-group heading="listagem de Ordem de Servicos Pendente de Ciencia" >

			<h4>Lista de Ordem de Serviço para dar Ciencias</h4><!--button class="btn btn-primary btn-login" onclick="Acao('Nv','','','','','','')">Novo</button-->&nbsp;
			<button class="btn btn-primary btn-login" onclick="Acao('Psq','','','','','','')" title="Informe a palavra ( todos ) quando desejar listar todos os registros cadastrados">Pesquisar</button>
			<table class="table table-striped table-condensed">
				<thead>
				<tr class="login-header">
				<th style="min-width: 60px;">Usuario de Rede</th><th style="min-width: 60px;">Data do Aceite</th><th style="min-width: 60px;">Ordem de Serviço</th><th style="min-width: 60px;">Sequencia</th><th style="min-width: 60px;">Pessoa</th><th style="min-width: 60px;">Situaçao</th>
				</tr>
				</thead>
				<tbody>
					<% if(OrdemServicoCiencia.length > 0) { %>
	    				<% for(var i = 0; i < OrdemServicoCiencia.length; i++) {%>
							<tr>
								<td><%=OrdemServicoCiencia[i].codigousuariorede%></td><td><%=OrdemServicoCiencia[i].dataciencia%></td><td><%=OrdemServicoCiencia[i].idordemservico%></td><td><%=OrdemServicoCiencia[i].idOrdemServicoCiencia%></td><td><%=OrdemServicoCiencia[i].idpessoa%></td><td><%=OrdemServicoCiencia[i].status%></td>					
								<td><%if (OrdemServicoCiencia[i].status == 0) {%>
									<button class="btn btn-primary btn-login" onclick="Acao('Ed','<%=OrdemServicoCiencia[i].codigousuariorede%>','<%=OrdemServicoCiencia[i].dataciencia%>','<%=OrdemServicoCiencia[i].idordemservico%>','<%=OrdemServicoCiencia[i].idOrdemServicoCiencia%>','<%=OrdemServicoCiencia[i].idpessoa%>','<%=OrdemServicoCiencia[i].status%>','<%=OrdemServicoCiencia[i].corpo%>')">editar</button>
									<%}else{%>
											<button class="btn btn-primary btn-login" onclick="Acao('Ed','<%=OrdemServicoCiencia[i].codigousuariorede%>','<%=OrdemServicoCiencia[i].dataciencia%>','<%=OrdemServicoCiencia[i].idordemservico%>','<%=OrdemServicoCiencia[i].idOrdemServicoCiencia%>','<%=OrdemServicoCiencia[i].idpessoa%>','<%=OrdemServicoCiencia[i].status%>')">Ativar</button>
									<% } %>
									<%if (OrdemServicoCiencia[i].status == 0) {%>
									<button class="btn btn-primary btn-login" onclick="Acao('Ex','<%=OrdemServicoCiencia[i].codigousuariorede%>','<%=OrdemServicoCiencia[i].dataciencia%>','<%=OrdemServicoCiencia[i].idordemservico%>','<%=OrdemServicoCiencia[i].idOrdemServicoCiencia%>','<%=OrdemServicoCiencia[i].idpessoa%>','<%=OrdemServicoCiencia[i].status%>')">excluir</button>
									<% } %>
								</td>

							</tr>
						<% } %>
					<% } %>
				</tbody>
			</table>
	
	</accordion-group>
				</div>
											
							</div>
						</div>
					</div>
                </div>

                <div class="col-md-2"></div>
            </div>
        </div>
		
	</body>
</html>